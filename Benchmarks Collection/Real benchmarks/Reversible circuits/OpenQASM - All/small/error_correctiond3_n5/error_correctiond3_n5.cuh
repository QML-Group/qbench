#ifndef CIRCUIT_CUH
#define CIRCUIT_CUH

// Error correction: distance-three 5-qubit code, from the paper "Benchmarking gate-based quantum computers" by K. Michielsen et al.
__device__ __inline__ void circuit(double* dm_real, double* dm_imag)
{
	H(0);
	H(1);
	ID(2);
	H(3);
	H(4);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	CX(4, 2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	SDG(4);
	CX(4, 2);
	H(2);
	CX(4, 2);
	H(2);
	CX(0, 2);
	H(0);
	H(2);
	CX(0, 2);
	H(0);
	H(2);
	CX(0, 2);
	CX(3, 2);
	CX(0, 2);
	H(0);
	H(2);
	CX(0, 2);
	H(0);
	H(2);
	CX(0, 2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	CX(3, 2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	H(1);
	H(2);
	CX(1, 2);
	CX(3, 2);
	CX(0, 2);
	H(3);
	H(4);
	CX(3, 2);
	H(2);
	H(3);
	CX(3, 2);
	H(2);
	H(3);
	CX(3, 2);
	CX(0, 2);
	CX(3, 2);
	H(2);
	H(3);
	CX(3, 2);
	H(2);
	H(3);
	CX(3, 2);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	CX(0, 2);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	CX(1, 2);
	H(2);
	CX(1, 2);
	H(1);
	CX(4, 2);
	CX(0, 1);
	H(2);
	H(4);
	H(1);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	CX(1, 2);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	H(2);
	H(4);
	CX(4, 2);
	SDG(1);
	H(2);
	H(3);
	H(4);
}
#endif
